<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>La Garka — Tienda artesanal (Beta)</title>
  <style>
    :root{
      --bg1:#ffe0ea; /* rosa pastel */
      --bg2:#fff3d4; /* ámbar muy claro */
      --bg3:#ffe9ee; /* rose */
      --ink:#1f2937; /* slate-800 */
      --primary:#FF4D6D; /* rosa vivo */
      --secondary:#6C63FF; /* violeta */
      --accent:#00C2A8; /* menta */
      --soft:#FFE3EC; /* rosa suave */
      --card: rgba(255,255,255,.75);
      --border: rgba(255,255,255,.7);
      --shadow: 0 6px 18px rgba(0,0,0,.06);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink);
      background: linear-gradient(180deg,var(--bg1),var(--bg2) 50%, var(--bg3));
    }
    a{color:inherit}
    .container{max-width:1200px;margin:0 auto;padding:0 16px}
    header{position:sticky;top:0;z-index:50;backdrop-filter: blur(10px); background: rgba(255,255,255,.6); border-bottom:1px solid var(--border)}
    .topbar{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:38px;height:38px;border-radius:12px;display:grid;place-items:center;font-weight:900;color:#fff;
      background: conic-gradient(from 90deg at 50% 50%, var(--primary), var(--secondary), var(--accent), var(--primary));}
    .chip{font-size:12px;padding:4px 8px;border-radius:999px;background:var(--soft);}
    nav{display:none;gap:24px;font-size:14px}
    @media (min-width: 768px){nav{display:flex}}

    /* Sections */
    section{padding:64px 0}
    .hero{padding:64px 0}
    .grid{display:grid;gap:24px}
    .g-cols-2{grid-template-columns:1fr}
    @media (min-width: 900px){.g-cols-2{grid-template-columns:1fr 1fr}}
    .mosaic{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .mosaic .cell{aspect-ratio:1;border-radius:20px;overflow:hidden;border:1px solid var(--border);box-shadow:var(--shadow)}
    .mosaic img{width:100%;height:100%;object-fit:cover}

    .btn{display:inline-block;padding:10px 16px;border-radius:999px;border:1px solid transparent;font-weight:600;cursor:pointer}
    .btn-primary{background:var(--primary);color:#fff}
    .btn-outline-primary{border-color:var(--primary);color:var(--primary);background:transparent}
    .btn-accent{background:var(--accent);color:#fff}
    .btn-outline-accent{border-color:var(--accent);color:var(--accent);background:transparent}

    .toolbar{display:flex;flex-direction:column;gap:12px}
    @media (min-width: 768px){.toolbar{flex-direction:row;align-items:center}}
    .search{position:relative;flex:1}
    .search input{width:100%;padding:14px 40px 14px 16px;border-radius:999px;border:1px solid #e5e7eb;background:rgba(255,255,255,.8)}
    .search .hint{position:absolute;right:12px;top:50%;transform:translateY(-50%);opacity:.6;font-size:12px}

    .filters{display:flex;gap:8px;overflow:auto;padding-bottom:6px}
    .pill{padding:8px 14px;border-radius:999px;border:1px solid var(--primary);white-space:nowrap;font-size:14px;background:transparent;color:var(--primary)}
    .pill.active{background:var(--primary);color:#fff}

    .cards{display:grid;gap:20px;grid-template-columns:1fr}
    @media (min-width:640px){.cards{grid-template-columns:repeat(2,1fr)}}
    @media (min-width:1000px){.cards{grid-template-columns:repeat(3,1fr)}}

    .card{border:1px solid var(--border);background:var(--card);border-radius:22px;overflow:hidden;box-shadow:var(--shadow);transition:box-shadow .2s}
    .card:hover{box-shadow:0 10px 30px rgba(0,0,0,.08)}
    .card img{width:100%;height:220px;object-fit:cover}
    .badge{position:absolute;top:10px;left:10px;background:rgba(0,0,0,.8);color:#fff;font-size:12px;border-radius:999px;padding:4px 8px}
    .card-body{padding:14px}
    .muted{color:#64748b;font-size:14px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:10px}

    /* Drawers & Modals */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none}
    .drawer{position:fixed;top:0;right:0;height:100%;width:min(420px,100%);background:#fff;border-radius:24px 0 0 24px;box-shadow:0 10px 30px rgba(0,0,0,.2);padding:20px;display:flex;flex-direction:column}
    .modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(600px,95%);background:#fff;border-radius:24px;box-shadow:0 10px 30px rgba(0,0,0,.2);padding:20px}
    .list{display:flex;flex-direction:column;gap:12px;overflow:auto}
    .line{display:flex;gap:10px;align-items:center;border:1px solid #eee;border-radius:16px;padding:10px}
    .thumb{width:64px;height:64px;border-radius:12px;object-fit:cover}
    .qty{display:inline-flex;align-items:center;border:1px solid #e5e7eb;border-radius:999px}
    .qty button{border:none;background:transparent;padding:6px 10px;font-size:18px;cursor:pointer}
    .qty span{padding:0 8px}
    .text-xs{font-size:12px;color:#64748b}
    footer{border-top:1px solid var(--border);background:rgba(255,255,255,.6)}

    /* forms */
    input, select, textarea{border:1px solid #e5e7eb;border-radius:14px;padding:10px;background:#fff;width:100%}
    textarea{min-height:100px;resize:vertical}

    .hidden{display:none}
  </style>
</head>
<body>
  <header>
    <div class="container topbar">
      <div class="brand">
        <div class="logo">LG</div>
        <strong style="color:var(--primary)">La Garka</strong>
        <span class="chip">artesanal · hecho a mano</span>
      </div>
      <nav>
        <a href="#catalogo">Catálogo</a>
        <a href="#encargos">Encargos</a>
        <a href="#sobre">Sobre mí</a>
        <a href="#contacto">Contacto</a>
      </nav>
      <div>
        <button id="btnCart" class="btn" aria-label="Abrir carrito" title="Carrito">🛒<span id="cartBadge" class="chip" style="margin-left:8px;display:none">0</span></button>
      </div>
    </div>
  </header>

  <main>
    <!-- Hero -->
    <section class="hero">
      <div class="container grid g-cols-2" style="align-items:center">
        <div>
          <h1 style="font-size:40px;line-height:1.1;margin:0 0 12px 0;font-weight:900">Colores que cuentan <span style="color:var(--primary)">tu historia</span></h1>
          <p class="muted" style="max-width:540px">Pulseras, charms, tote bags y ropa con diseño propio. Piezas únicas hechas a mano, con opción de <b>encargo personalizado</b> para que sea 100% tu estilo.</p>
          <div style="margin-top:18px;display:flex;gap:10px;flex-wrap:wrap">
            <a href="#catalogo" class="btn btn-primary">Ver catálogo</a>
            <a href="#encargos" class="btn btn-outline-primary">Pedir a medida</a>
          </div>
          <div class="text-xs" style="margin-top:10px">
            <a href="https://www.instagram.com/la_garka" target="_blank" rel="noreferrer" style="text-decoration:underline">@la_garka</a> · DMs abiertos
          </div>
        </div>
        <div>
          <div class="mosaic">
            <div class="cell"><img src="img/1.jpg" alt="mood 1"></div>
            <div class="cell"><img src="img/2.jpg" alt="mood 2"></div>
            <div class="cell"><img src="img/3.jpg" alt="mood 3"></div>
            <div class="cell"><img src="img/4.jpg" alt="mood 4"></div>
            <div class="cell"><img src="img/5.jpg" alt="mood 5"></div>
            <div class="cell"><img src="img/6.jpg" alt="mood 6"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Catálogo -->
    <section id="catalogo">
      <div class="container">
        <div class="toolbar">
          <div class="search">
            <input id="search" placeholder="Buscar: pulseras, tote, charms…" />
            <span class="hint">Ctrl/⌘K</span>
          </div>
          <div class="filters" id="filters"></div>
        </div>
        <div class="cards" id="cards" style="margin-top:20px"></div>
      </div>
    </section>

    <!-- Encargos a medida -->
    <section id="encargos">
      <div class="container">
        <div class="card" style="padding:22px">
          <h2 style="margin:0 0 8px 0;font-size:28px;font-weight:900">Encargos a medida</h2>
          <p class="muted" style="max-width:760px">¿Tienes una idea? Cuéntame colores, medidas, nombre/fecha, referencias y presupuesto. Te propongo un boceto y materiales antes de empezar.</p>
          <form id="customOrder" style="margin-top:16px;display:grid;gap:12px;grid-template-columns:1fr;">
            <div class="grid" style="grid-template-columns:1fr;gap:12px">
              <input required placeholder="Tu nombre" />
              <input required placeholder="Contacto (Instagram / WhatsApp)" />
            </div>
            <div class="grid" style="grid-template-columns:1fr 1fr;gap:12px">
              <select>
                <option>Pulsera</option>
                <option>Charm</option>
                <option>Tote bag</option>
                <option>Ropa</option>
                <option>Otro</option>
              </select>
              <input placeholder="Presupuesto aproximado (€)" />
            </div>
            <textarea placeholder="Cuéntame tu idea: colores, medidas, texto, referencias…"></textarea>
            <button class="btn" style="background:var(--secondary);color:#fff;width:fit-content">Enviar idea</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Sobre mí -->
    <section id="sobre">
      <div class="container grid g-cols-2" style="align-items:center">
        <div class="card"><img src="img/10.jpg" alt="taller" style="width:100%;height:320px;object-fit:cover;border-radius:22px"/></div>
        <div>
          <h2 style="font-size:28px;font-weight:900;margin:0 0 8px">Hecho con cariño</h2>
          <p class="muted">Cada pieza se crea manualmente en Barcelona, seleccionando materiales con mimo y buscando combinaciones de color alegres. Inspiración directa de la comunidad de <b>Instagram</b>: comparte tu idea y la hacemos realidad.</p>
        </div>
      </div>
    </section>

    <!-- Contacto -->
    <section id="contacto">
      <div class="container">
        <div class="card" style="padding:22px;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:12px">
          <div>
            <h3 style="margin:0;font-size:22px;font-weight:800">¿Hablamos?</h3>
            <p class="muted" style="margin:6px 0 0 0">Pedidos, dudas o colaboraciones.</p>
          </div>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <a class="btn btn-accent" target="_blank" rel="noreferrer" href="https://wa.me/34692833444">WhatsApp</a>
            <a class="btn btn-outline-accent" target="_blank" rel="noreferrer" href="https://www.instagram.com/la_garka">Instagram</a>
            <a class="btn btn-outline-accent" href="mailto:hola@lagarka.com" style="border-color:var(--ink);color:var(--ink)">Email</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Cart Drawer -->
  <div id="overlay" class="overlay"></div>
  <aside id="cart" class="drawer hidden" aria-label="Carrito">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <strong>Tu carrito</strong>
      <button id="closeCart" class="btn" aria-label="Cerrar">✕</button>
    </div>
    <div id="cartList" class="list" style="margin-top:14px;flex:1;overflow:auto"></div>
    <div style="border-top:1px solid #eee;padding-top:12px">
      <div style="display:flex;align-items:center;justify-content:space-between;font-weight:700">
        <span>Total</span>
        <span id="cartTotal">0,00 €</span>
      </div>
      <button id="checkout" class="btn btn-primary" style="width:100%;margin-top:10px">Finalizar compra</button>
      <p class="text-xs" style="margin-top:6px">Envíos 24-72h · Devoluciones 14 días · Hecho a mano con amor ❤️</p>
    </div>
  </aside>

  <!-- Customizer Modal -->
  <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <h4 id="modalTitle" style="margin:0;font-size:18px;font-weight:800">Personalizar</h4>
      <button id="closeModal" class="btn">✕</button>
    </div>
    <form id="customizeForm" style="margin-top:12px;display:grid;gap:12px">
      <div class="grid" style="grid-template-columns:1fr 1fr;gap:12px">
        <div>
          <label class="text-xs">Talla/Medida</label>
          <select id="cSize"></select>
        </div>
        <div>
          <label class="text-xs">Color principal</label>
          <input id="cColor" placeholder="rosa, menta…" />
        </div>
      </div>
      <div>
        <label class="text-xs">Notas</label>
        <textarea id="cNote" placeholder="nombre/fecha, medidas exactas, referencias…"></textarea>
      </div>
      <div style="display:flex;justify-content:flex-end;gap:8px">
        <button type="button" id="cancelModal" class="btn">Cancelar</button>
        <button type="submit" class="btn btn-primary">Añadir al carrito</button>
      </div>
    </form>
  </div>

  <footer>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;padding:18px 0;gap:12px;flex-wrap:wrap;font-size:14px">
      <div style="opacity:.7">© <span id="year"></span> La Garka. Hecho a mano en Barcelona.</div>
      <div style="display:flex;gap:16px">
        <a href="#">Política de envíos</a>
        <a href="#">Cambios y devoluciones</a>
        <a href="#">Privacidad</a>
      </div>
    </div>
  </footer>

<script>
// === Datos iniciales ===
const CATEGORIES = [
  { key: 'all', label: 'Todo' },
  { key: 'pulseras', label: 'Pulseras' },
  { key: 'charms', label: 'Charms' },
  { key: 'totebags', label: 'Tote bags' },
  { key: 'ropa', label: 'Ropa' },
  { key: 'accesorios', label: 'Accesorios' },
];

const PRODUCTS = [
  { id:'puls-001', name:'Pulsera “Candy Pop”', price:14.9, category:'pulseras', tags:['perlas','pastel','hecho a mano'], colors:['multicolor','rosa','menta'], imageUrl:'img/11.jpg', madeToOrder:true },
  { id:'chrm-001', name:'Charm “Lucky Mini”', price:7.5, category:'charms', tags:['llavero','resina','cute'], colors:['violeta','menta'], imageUrl:'img/12.jpg', madeToOrder:false },
  { id:'tote-001', name:'Totebag “La Garka”', price:19.9, category:'totebags', tags:['algodón orgánico','serigrafía'], colors:['crudo','negro'], imageUrl:'img/13.jpg', madeToOrder:true },
  { id:'ropa-001', name:'Camiseta diseño propio', price:24.9, category:'ropa', tags:['diseño propio','DTF','personalizable'], colors:['blanco','negro'], imageUrl:'img/14.jpg', madeToOrder:true },
  { id:'acc-001', name:'Scrunchie satén', price:6.0, category:'accesorios', tags:['pelo','satén'], colors:['rosa','lila'], imageUrl:'img/15.jpg', madeToOrder:false },
];

// === Estado ===
let state = {
  query: '',
  cat: 'all',
  cart: [],
  customProduct: null, // {product}
};

// === Utilidades ===
const EUR = new Intl.NumberFormat('es-ES', {style:'currency', currency:'EUR'}); // (fix) no usar identificador "€"
const $ = (sel, el=document) => el.querySelector(sel);
const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

function setState(patch){ state = {...state, ...patch}; render(); }

function filterProducts(){
  return PRODUCTS.filter(p => {
    const inCat = state.cat === 'all' || p.category === state.cat;
    const q = state.query.trim().toLowerCase();
    const inQuery = !q || (p.name + ' ' + p.tags.join(' ')).toLowerCase().includes(q);
    return inCat && inQuery;
  });
}

function addToCart(item, extras={}){
  const key = `${item.id}-${extras.size||'std'}-${extras.color||'mix'}-${extras.note||''}`;
  const idx = state.cart.findIndex(l => l.key === key);
  if(idx>=0){
    const cart = [...state.cart];
    cart[idx].qty += 1;
    setState({cart});
  } else {
    setState({cart:[...state.cart, { key, id:item.id, name:item.name, price:item.price, imageUrl:item.imageUrl, qty:1, ...extras }]});
  }
  openCart();
}

function cartTotal(){
  return state.cart.reduce((a,b)=> a + b.price * b.qty, 0);
}

// === Render ===
function renderFilters(){
  const wrap = $('#filters');
  wrap.innerHTML = '';
  CATEGORIES.forEach(c => {
    const b = document.createElement('button');
    b.className = 'pill' + (state.cat === c.key ? ' active' : '');
    b.textContent = c.label;
    b.onclick = () => setState({cat:c.key});
    wrap.appendChild(b);
  });
}

function renderCards(){
  const list = $('#cards');
  list.innerHTML = '';
  const items = filterProducts();
  items.forEach(p => {
    const art = document.createElement('article');
    art.className = 'card';
    art.innerHTML = `
      <div style="position:relative">
        <img src="${p.imageUrl}" alt="${p.name}" />
        ${p.madeToOrder ? '<span class="badge">a medida</span>' : ''}
      </div>
      <div class="card-body">
        <h3 style="margin:0;font-weight:700">${p.name}</h3>
        <p class="muted">${p.tags.join(' · ')}</p>
        <div class="row">
          <span style="font-weight:700">${EUR.format(p.price)}</span>
          <div style="display:flex;gap:8px">
            <button data-id="${p.id}" class="btn btn-outline-primary btn-custom">Personalizar</button>
            <button data-id="${p.id}" class="btn btn-primary btn-add">Añadir</button>
          </div>
        </div>
      </div>`;
    list.appendChild(art);
  });

  // Bind events
  $$('.btn-add', list).forEach(b=> b.onclick = () => {
    const prod = PRODUCTS.find(x => x.id === b.dataset.id);
    addToCart(prod);
  });
  $$('.btn-custom', list).forEach(b=> b.onclick = () => {
    const prod = PRODUCTS.find(x => x.id === b.dataset.id);
    openCustomizer(prod);
  });
}

function renderCart(){
  const badge = $('#cartBadge');
  const count = state.cart.reduce((a,b)=>a+b.qty,0);
  badge.style.display = count ? 'inline-block' : 'none';
  badge.textContent = count;

  const list = $('#cartList');
  list.innerHTML = '';
  if(!state.cart.length){
    list.innerHTML = '<p class="muted">Aún no hay productos.</p>';
  } else {
    state.cart.forEach(line => {
      const el = document.createElement('div');
      el.className = 'line';
      el.innerHTML = `
        <img class="thumb" src="${line.imageUrl}" alt="mini" />
        <div style="flex:1">
          <div style="font-weight:600">${line.name}</div>
          ${ (line.size||line.color||line.note) ? `<div class="text-xs">${[line.size,line.color,line.note].filter(Boolean).join(' · ')}</div>` : ''}
          <div style="font-size:14px">${EUR.format(line.price)} × ${line.qty}</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-end">
          <div class="qty">
            <button aria-label="menos">−</button>
            <span>${line.qty}</span>
            <button aria-label="más">+</button>
          </div>
          <button class="text-xs" style="color:#e11d48;background:none;border:none;cursor:pointer">Eliminar</button>
        </div>`;

      // qty handlers
      el.querySelectorAll('.qty button')[0].onclick = () => {
        const cart = state.cart.map(l => l.key===line.key ? {...l, qty: Math.max(1, l.qty - 1)} : l);
        setState({cart});
      };
      el.querySelectorAll('.qty button')[1].onclick = () => {
        const cart = state.cart.map(l => l.key===line.key ? {...l, qty: l.qty + 1} : l);
        setState({cart});
      };
      el.querySelector('button.text-xs').onclick = () => {
        setState({cart: state.cart.filter(l => l.key !== line.key)});
      };

      list.appendChild(el);
    });
  }
  $('#cartTotal').textContent = EUR.format(cartTotal());
}

function render(){
  renderFilters();
  renderCards();
  renderCart();
}

// === Customizer ===
function openCustomizer(product){
  state.customProduct = product;
  $('#modalTitle').textContent = 'Personalizar: ' + product.name;
  const sizeSel = $('#cSize');
  sizeSel.innerHTML='';
  let sizes = ['Única'];
  if(product.category==='pulseras') sizes = ['XS','S','M','L'];
  else if(product.category==='ropa') sizes = ['S','M','L','XL'];
  sizes.forEach(s=>{ const o=document.createElement('option'); o.value=o.textContent=s; sizeSel.appendChild(o); });
  $('#cColor').value = product.colors?.[0] || '';
  $('#cNote').value = '';
  showModal(true);
}

$('#customizeForm').onsubmit = (e)=>{
  e.preventDefault();
  const extras = { size: $('#cSize').value||'Única', color: $('#cColor').value||'mix', note: $('#cNote').value||'' };
  addToCart(state.customProduct, extras);
  showModal(false);
};

// === Cart Drawer interactions ===
const overlay = $('#overlay');
const cart = $('#cart');
function openCart(){ overlay.style.display='block'; cart.classList.remove('hidden'); }
function closeCart(){ overlay.style.display='none'; cart.classList.add('hidden'); }
$('#btnCart').onclick = openCart;
$('#closeCart').onclick = closeCart;
overlay.onclick = ()=>{ closeCart(); showModal(false); };

function showModal(show){
  const m = $('#modal');
  if(show){ overlay.style.display='block'; m.classList.remove('hidden'); }
  else{ m.classList.add('hidden'); if(!cart.classList.contains('hidden')) overlay.style.display='block'; else overlay.style.display='none'; }
}
$('#closeModal').onclick = ()=> showModal(false);
$('#cancelModal').onclick = ()=> showModal(false);

// === Search / Keyboard ===
$('#search').oninput = (e)=> setState({query: e.target.value});
window.addEventListener('keydown', (e)=>{
  if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='k'){ e.preventDefault(); $('#search').focus(); }
});

// === Forms ===
$('#customOrder').onsubmit = (e)=>{ e.preventDefault(); alert('¡Gracias! Te escribiré por IG/WhatsApp para concretar tu encargo ✨'); e.target.reset(); };
$('#checkout').onclick = ()=> alert('Checkout simulado. Integraremos Stripe/TPV cuando quieras.');

// === Mini test suite (no intrusiva) ===
(function runTests(){
  try {
    console.group('%cTests La Garka','color:#6C63FF;font-weight:bold');
    const snap = JSON.parse(JSON.stringify(state));
    const wasOverlay = overlay.style.display;
    const cartWasHidden = cart.classList.contains('hidden');

    console.assert(Array.isArray(PRODUCTS) && PRODUCTS.length >= 3, 'PRODUCTS debe tener al menos 3 ítems');

    // 1) Filtro por defecto
    console.assert(filterProducts().length === PRODUCTS.length, 'Filtro por defecto debería mostrar todos');

    // 2) Filtro por categoría
    state.cat = 'pulseras';
    const onlyBracelets = filterProducts();
    console.assert(onlyBracelets.length >= 1 && onlyBracelets.every(p=>p.category==='pulseras'), 'Filtro por pulseras');

    // 3) Formato moneda
    const f = EUR.format(12.5);
    console.assert(/€/.test(f), 'Debe incluir símbolo €');

    // 4) Carrito suma cantidades
    state.cart = [];
    addToCart(PRODUCTS[0]);
    addToCart(PRODUCTS[0]);
    console.assert(state.cart.length === 1 && state.cart[0].qty === 2, 'Añadir duplica cantidad, no líneas');

    // 5) Customizer tallas pulsera
    const bracelet = PRODUCTS.find(p=>p.category==='pulseras');
    if (bracelet){
      openCustomizer(bracelet);
      const opts = Array.from(document.querySelectorAll('#cSize option')).map(o=>o.value);
      console.assert(opts.join(',').includes('XS') && opts.length === 4, 'Tallas pulsera XS,S,M,L');
      showModal(false);
    }

    // Restore
    state = snap; render();
    overlay.style.display = wasOverlay; if (cartWasHidden) cart.classList.add('hidden');
    console.info('✅ Tests ok');
    console.groupEnd();
  } catch(err){
    console.error('Tests failed', err);
  }
})();

// Init
$('#year').textContent = new Date().getFullYear();
render();
</script>
</body>
</html>
